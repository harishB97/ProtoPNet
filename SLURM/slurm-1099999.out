start load env and run python
Resetting modules to system default
Resetting modules to system default
/cm/local/apps/slurm/var/spool/job1099999/slurm_script: line 21: activate: No such file or directory
/home/harishbabu/.conda/envs/taming3/bin/python
0
Add on layers type: regular_with_batchnorm
mean (0.7451, 0.7302, 0.6958) std (0.1604, 0.1922, 0.2335)
Running: 063-fish-pad1-lvl2-256-vgg19_bn-10ppc-10ep-crcted_mean_std-bn_before_sigmoid
training set size: 124200
push set size: 4140
test set size: 1294
batch size: 80
Restored model form /home/harishbabu/projects/ProtoPNet/saved_models/vgg19_bn/063-fish-pad1-lvl2-256-vgg19_bn-10ppc-10ep-crcted_mean_std-bn_before_sigmoid/9nopush0.9985.pth
Optimizer type: adam
start_epoch: 10
start training
epoch: 	10
	joint
	train
/home/harishbabu/.conda/envs/taming3/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
	time: 	978.5264885425568
	cross ent: 	0.012259722686704328
	cluster: 	0.48813140071827754
	separation:	68.78478661001074
	avg separation:	78.32128919022972
	accu: 		99.92351046698873%
	f1: 		99.92350935935974%
	l1: 		450.0
	p dist pair: 	92.72241973876953
	test
	time: 	4.611921310424805
	cross ent: 	0.06585836378955999
	cluster: 	1.1481015796844776
	separation:	68.4719015268179
	avg separation:	81.60550454946664
	accu: 		98.84080370942813%
	f1: 		98.84080290794373%
	l1: 		450.0
	p dist pair: 	92.72241973876953
	above 10.00%
	push
main.py:215: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  metrics_df = metrics_df.append({'ep':epoch, **train_metrics, **test_metrics}, ignore_index=True)
	Executing push ...
	push time: 	34.31660485267639
	test
	time: 	4.787160158157349
	cross ent: 	0.3480412042380382
	cluster: 	0.4637232029966841
	separation:	6.9809441440380535
	avg separation:	56.52314670269306
	accu: 		98.37712519319938%
	f1: 		98.377126455307%
	l1: 		450.0
	p dist pair: 	50.42892837524414
	above 10.00%
	last layer
iteration: 	0
	train
	time: 	339.9792854785919
	cross ent: 	0.187838114506455
	cluster: 	0.28445186591700894
	separation:	6.99341819874333
	avg separation:	56.51857156747399
	accu: 		98.88083735909822%
	f1: 		98.88083934783936%
	l1: 		380.53814697265625
	p dist pair: 	50.42892837524414
	test
	time: 	5.286408185958862
	cross ent: 	0.16442427863171252
	cluster: 	0.23669849220179737
	separation:	6.956317917730373
	avg separation:	56.575391622690056
	accu: 		99.0726429675425%
	f1: 		99.07264113426208%
	l1: 		380.53814697265625
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	1
	train
	time: 	342.98813796043396
	cross ent: 	0.16453848525629766
	cluster: 	0.2852608216419903
	separation:	6.991903346043898
	avg separation:	56.51969980901852
	accu: 		98.9194847020934%
	f1: 		98.91948699951172%
	l1: 		316.9107666015625
	p dist pair: 	50.42892837524414
	test
	time: 	4.631022214889526
	cross ent: 	0.19572068449182412
	cluster: 	0.30389780252023857
	separation:	6.925968109021107
	avg separation:	56.59264197716346
	accu: 		98.91808346213293%
	f1: 		98.9180862903595%
	l1: 		316.9107666015625
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	2
	train
	time: 	341.28560280799866
	cross ent: 	0.14066250031433242
	cluster: 	0.2810182995522111
	separation:	6.9921443095455915
	avg separation:	56.52007326616138
	accu: 		98.99194847020934%
	f1: 		98.99194836616516%
	l1: 		255.43975830078125
	p dist pair: 	50.42892837524414
	test
	time: 	4.490862607955933
	cross ent: 	0.18284091693000776
	cluster: 	0.32751315580124074
	separation:	6.915639891969756
	avg separation:	56.59127836961012
	accu: 		98.91808346213293%
	f1: 		98.9180862903595%
	l1: 		255.43975830078125
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	3
	train
	time: 	341.3457520008087
	cross ent: 	0.12120728171278493
	cluster: 	0.2791211420426021
	separation:	6.992708932178986
	avg separation:	56.518383551779976
	accu: 		99.03784219001611%
	f1: 		99.03784394264221%
	l1: 		221.42959594726562
	p dist pair: 	50.42892837524414
	test
	time: 	5.568273067474365
	cross ent: 	0.15010340772217362
	cluster: 	0.30142136363922245
	separation:	6.939468339228859
	avg separation:	56.5870481637808
	accu: 		98.91808346213293%
	f1: 		98.9180862903595%
	l1: 		221.42959594726562
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	4
	train
	time: 	341.5191550254822
	cross ent: 	0.10302828161179875
	cluster: 	0.28524445938335113
	separation:	6.994007654982234
	avg separation:	56.52209904235329
	accu: 		99.09178743961353%
	f1: 		99.09178614616394%
	l1: 		212.3278045654297
	p dist pair: 	50.42892837524414
	test
	time: 	4.825970888137817
	cross ent: 	0.12190522911336862
	cluster: 	0.2751905726195568
	separation:	6.9353590272367
	avg separation:	56.582653339092545
	accu: 		99.0726429675425%
	f1: 		99.07264113426208%
	l1: 		212.3278045654297
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	5
	train
	time: 	348.61799716949463
	cross ent: 	0.08948589469690596
	cluster: 	0.2867365862662456
	separation:	6.991988405901926
	avg separation:	56.51899198985299
	accu: 		99.15378421900161%
	f1: 		99.1537868976593%
	l1: 		203.8309326171875
	p dist pair: 	50.42892837524414
	test
	time: 	5.195287227630615
	cross ent: 	0.1062647072107071
	cluster: 	0.2837469094958159
	separation:	6.94006099143567
	avg separation:	56.593717721792366
	accu: 		99.1499227202473%
	f1: 		99.14992451667786%
	l1: 		203.8309326171875
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	6
	train
	time: 	342.21163964271545
	cross ent: 	0.06808402659834546
	cluster: 	0.2798770363345103
	separation:	6.992950747416853
	avg separation:	56.5220461622485
	accu: 		99.25925925925925%
	f1: 		99.25925731658936%
	l1: 		197.4805908203125
	p dist pair: 	50.42892837524414
	test
	time: 	5.365606307983398
	cross ent: 	0.10223791944988009
	cluster: 	0.3187697252900272
	separation:	6.913860451286802
	avg separation:	56.58317712637094
	accu: 		99.22720247295209%
	f1: 		99.22720193862915%
	l1: 		197.4805908203125
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	7
	train
	time: 	340.78529167175293
	cross ent: 	0.05737410056884073
	cluster: 	0.2864399707573638
	separation:	6.992851648189449
	avg separation:	56.52086994836811
	accu: 		99.35990338164251%
	f1: 		99.35990571975708%
	l1: 		193.46414184570312
	p dist pair: 	50.42892837524414
	test
	time: 	5.81759238243103
	cross ent: 	0.08036849750452837
	cluster: 	0.28246633843082236
	separation:	6.942533892794297
	avg separation:	56.593033423790565
	accu: 		99.45904173106645%
	f1: 		99.45904016494751%
	l1: 		193.46414184570312
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	8
	train
	time: 	343.4180886745453
	cross ent: 	0.04322620822082607
	cluster: 	0.2876163556845336
	separation:	6.991480241954825
	avg separation:	56.51918348618192
	accu: 		99.47262479871175%
	f1: 		99.47262406349182%
	l1: 		189.29107666015625
	p dist pair: 	50.42892837524414
	test
	time: 	4.957631349563599
	cross ent: 	0.07608368947118051
	cluster: 	0.324295742495696
	separation:	6.928213062696159
	avg separation:	56.58208201481746
	accu: 		99.53632148377125%
	f1: 		99.53632354736328%
	l1: 		189.29107666015625
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	9
	train
	time: 	343.78540802001953
	cross ent: 	0.03275422293004256
	cluster: 	0.28588072152019844
	separation:	6.9933228571032675
	avg separation:	56.52276957672178
	accu: 		99.5877616747182%
	f1: 		99.58776235580444%
	l1: 		182.6359100341797
	p dist pair: 	50.42892837524414
	test
	time: 	4.852108955383301
	cross ent: 	0.06661316048201535
	cluster: 	0.3171131548063106
	separation:	6.929923550225794
	avg separation:	56.59084701538086
	accu: 		99.61360123647604%
	f1: 		99.61360096931458%
	l1: 		182.6359100341797
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	10
	train
	time: 	342.0754916667938
	cross ent: 	0.026386096794021312
	cluster: 	0.27860400333090046
	separation:	6.993075876334215
	avg separation:	56.517380193058166
	accu: 		99.68679549114331%
	f1: 		99.68679547309875%
	l1: 		173.40951538085938
	p dist pair: 	50.42892837524414
	test
	time: 	5.129755735397339
	cross ent: 	0.057425406467042736
	cluster: 	0.2534259497534339
	separation:	6.936262750783219
	avg separation:	56.59249525803786
	accu: 		99.76816074188562%
	f1: 		99.76816177368164%
	l1: 		173.40951538085938
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	11
	train
	time: 	345.57849860191345
	cross ent: 	0.02338062007868588
	cluster: 	0.2843419921356535
	separation:	6.993494243984136
	avg separation:	56.52101723793162
	accu: 		99.74798711755234%
	f1: 		99.74798560142517%
	l1: 		162.25204467773438
	p dist pair: 	50.42892837524414
	test
	time: 	4.563354730606079
	cross ent: 	0.058384030168214945
	cluster: 	0.25091526579287277
	separation:	6.942147515785809
	avg separation:	56.5961547264686
	accu: 		99.84544049459042%
	f1: 		99.84543919563293%
	l1: 		162.25204467773438
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	12
	train
	time: 	327.8564782142639
	cross ent: 	0.022633951048534114
	cluster: 	0.2827606578836382
	separation:	6.993520186781039
	avg separation:	56.51928602858505
	accu: 		99.7584541062802%
	f1: 		99.75845217704773%
	l1: 		150.55862426757812
	p dist pair: 	50.42892837524414
	test
	time: 	5.7318642139434814
	cross ent: 	0.05364855935802272
	cluster: 	0.3266701544406925
	separation:	6.937043145012397
	avg separation:	56.57442914522611
	accu: 		99.76816074188562%
	f1: 		99.76816177368164%
	l1: 		150.55862426757812
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	13
	train
	time: 	345.8617789745331
	cross ent: 	0.022834709982428727
	cluster: 	0.2829601022089005
	separation:	6.9923277845401115
	avg separation:	56.521862779213244
	accu: 		99.76570048309179%
	f1: 		99.76570010185242%
	l1: 		138.88796997070312
	p dist pair: 	50.42892837524414
	test
	time: 	4.918806791305542
	cross ent: 	0.04612099462504095
	cluster: 	0.27532900519561454
	separation:	6.945629439746531
	avg separation:	56.58022660475511
	accu: 		99.84544049459042%
	f1: 		99.84543919563293%
	l1: 		138.88796997070312
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	14
	train
	time: 	345.7039909362793
	cross ent: 	0.020090100841600247
	cluster: 	0.27868224225019067
	separation:	6.9917888576878475
	avg separation:	56.518655616087216
	accu: 		99.76972624798712%
	f1: 		99.76972341537476%
	l1: 		128.13870239257812
	p dist pair: 	50.42892837524414
	test
	time: 	4.92305326461792
	cross ent: 	0.047393277680428655
	cluster: 	0.31567859872344484
	separation:	6.9350084426741185
	avg separation:	56.58527286236103
	accu: 		99.84544049459042%
	f1: 		99.84543919563293%
	l1: 		128.13870239257812
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	15
	train
	time: 	344.7257559299469
	cross ent: 	0.019434427900794502
	cluster: 	0.2814975500681008
	separation:	6.992100189826754
	avg separation:	56.522840687788
	accu: 		99.7866344605475%
	f1: 		99.78663325309753%
	l1: 		118.84223937988281
	p dist pair: 	50.42892837524414
	test
	time: 	4.862587928771973
	cross ent: 	0.045747124368797534
	cluster: 	0.3234863056888851
	separation:	6.928185901604593
	avg separation:	56.58918380737305
	accu: 		99.76816074188562%
	f1: 		99.76816177368164%
	l1: 		118.84223937988281
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	16
	train
	time: 	346.26576232910156
	cross ent: 	0.01966690398203952
	cluster: 	0.2809749733277873
	separation:	6.9924194011393475
	avg separation:	56.521892542694744
	accu: 		99.77536231884058%
	f1: 		99.77536201477051%
	l1: 		111.76835632324219
	p dist pair: 	50.42892837524414
	test
	time: 	5.172356843948364
	cross ent: 	0.041910665114583114
	cluster: 	0.2861316883910639
	separation:	6.9386422058853965
	avg separation:	56.58446502685547
	accu: 		99.84544049459042%
	f1: 		99.84543919563293%
	l1: 		111.76835632324219
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	17
	train
	time: 	348.2686951160431
	cross ent: 	0.02089228863740863
	cluster: 	0.28381148782826615
	separation:	6.992001353427816
	avg separation:	56.52022034202325
	accu: 		99.79066022544283%
	f1: 		99.79066252708435%
	l1: 		107.34559631347656
	p dist pair: 	50.42892837524414
	test
	time: 	4.661580562591553
	cross ent: 	0.04126769890810395
	cluster: 	0.28071563861375093
	separation:	6.924150319125217
	avg separation:	56.590861100416916
	accu: 		99.84544049459042%
	f1: 		99.84543919563293%
	l1: 		107.34559631347656
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	18
	train
	time: 	348.8784945011139
	cross ent: 	0.017632661743544067
	cluster: 	0.28160941838585163
	separation:	6.993293194178221
	avg separation:	56.52261807453379
	accu: 		99.79227053140096%
	f1: 		99.79227185249329%
	l1: 		103.74812316894531
	p dist pair: 	50.42892837524414
	test
	time: 	6.072334289550781
	cross ent: 	0.03631344311599076
	cluster: 	0.2683992089500512
	separation:	6.939056706328231
	avg separation:	56.585612076979416
	accu: 		99.84544049459042%
	f1: 		99.84543919563293%
	l1: 		103.74812316894531
	p dist pair: 	50.42892837524414
	above 10.00%
iteration: 	19
	train
	time: 	344.89598274230957
	cross ent: 	0.018565006030574035
	cluster: 	0.29019663883634944
	separation:	6.991408506363957
	avg separation:	56.51979760331487
	accu: 		99.78824476650564%
	f1: 		99.78824257850647%
	l1: 		101.48408508300781
	p dist pair: 	50.42892837524414
	test
main.py:253: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  metrics_df = metrics_df.append({'ep':epoch, **train_metrics, **test_metrics}, ignore_index=True)
	time: 	5.265782117843628
	cross ent: 	0.03708839581181914
	cluster: 	0.299975843215739
	separation:	6.920145301649777
	avg separation:	56.59147203885592
	accu: 		99.84544049459042%
	f1: 		99.84543919563293%
	l1: 		101.48408508300781
	p dist pair: 	50.42892837524414
	above 10.00%
Time elapsed: 8006.663984775543 seconds
